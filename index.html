<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>å…¨çƒæŒ‡æ•°çœ‹æ¿</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 20px;
    }
    h2 {
      text-align: center;
      margin-bottom: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
    }
    .card {
      background: #fff;
      padding: 15px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .price {
      font-size: 1.5em;
      font-weight: bold;
    }
    .high { color: green; }
    .low { color: red; }
    #last-updated {
      margin-top: 20px;
      text-align: center;
      font-size: 0.9em;
      color: #555;
    }
  </style>
</head>
<body>
  <h2>ğŸŒ å…¨çƒæŒ‡æ•°çœ‹æ¿</h2>
  <div class="grid">
    <div class="card" id="CSI300"></div>
    <div class="card" id="SP500"></div>
    <div class="card" id="Nasdaq"></div>
    <div class="card" id="HSI"></div>
  </div>
  <div id="last-updated"></div>

  <script>
    async function loadData() {
      try {
        const response = await fetch("data.json?_t=" + Date.now()); // é˜²æ­¢ç¼“å­˜
        const data = await response.json();

        const indices = ["CSI300", "SP500", "Nasdaq", "HSI"];

        indices.forEach(id => {
          const div = document.getElementById(id);
          const info = data[id];
          div.innerHTML = `
            <h3>${id}</h3>
            <div class="price">${info.price.toFixed(2)} ${info.currency}</div>
            <p>52å‘¨é«˜ç‚¹: <span class="high">${info.year_high}</span></p>
            <p>52å‘¨ä½ç‚¹: <span class="low">${info.year_low}</span></p>
            <div id="chart-${id}" style="width:100%;height:200px;"></div>
          `;

          // ç®€å•å±•ç¤ºé«˜ä½åŒºé—´
          const chart = echarts.init(document.getElementById("chart-" + id));
          chart.setOption({
            xAxis: {
              type: "category",
              data: ["ä½ç‚¹", "å½“å‰", "é«˜ç‚¹"]
            },
            yAxis: { type: "value" },
            series: [{
              data: [info.year_low, info.price, info.year_high],
              type: "line",
              smooth: true,
              areaStyle: {}
            }]
          });
        });

        document.getElementById("last-updated").innerText = 
          "â° æ•°æ®æ›´æ–°æ—¶é—´: " + data.last_updated;

      } catch (err) {
        console.error("åŠ è½½æ•°æ®å¤±è´¥:", err);
      }
    }

    loadData();
    setInterval(loadData, 60000); // æ¯åˆ†é’Ÿåˆ·æ–°
  </script>
</body>
</html>
