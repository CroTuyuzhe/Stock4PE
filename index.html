<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>å…¨çƒä¸»è¦æŒ‡æ•°ç›‘æ§</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
  <style>
    body {
      font-family: "Microsoft YaHei", sans-serif;
      background-color: #f5f7fa;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .container {
      display: flex;
      flex-direction: column;
      gap: 20px;
      max-width: 1200px;
      margin: auto;
    }
    .card {
      display: flex;
      justify-content: space-between;
      background: #fff;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }
    .info {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding-right: 20px;
    }
    .info h2 {
      margin: 0;
      font-size: 20px;
    }
    .info p {
      margin: 6px 0;
      font-size: 14px;
    }
    .chart {
      flex: 2;
      height: 200px;
    }
  </style>
</head>
<body>
  <h1>ğŸ“Š å…¨çƒä¸»è¦æŒ‡æ•°ç›‘æ§</h1>
  <div class="container" id="dashboard"></div>

  <script>
    async function loadData() {
      const res = await fetch("data.json"); // è¯»å–æœ¬åœ°ç”Ÿæˆçš„ JSON
      const data = await res.json();
      const container = document.getElementById("dashboard");
      container.innerHTML = "";

      const regionMap = {
        "CSI300": "ä¸­å›½å¤§é™†",
        "SP500": "ç¾å›½",
        "Nasdaq": "ç¾å›½",
        "HSI": "ä¸­å›½é¦™æ¸¯",
        "TWII": "ä¸­å›½å°æ¹¾"
      };

      Object.entries(data).forEach(([key, val]) => {
        if (key === "last_updated") return;

        // å¡ç‰‡å…ƒç´ 
        const card = document.createElement("div");
        card.className = "card";

        // å·¦ä¾§ä¿¡æ¯
        const info = document.createElement("div");
        info.className = "info";
        info.innerHTML = `
          <h2>${key}</h2>
          <p>åœ°åŒºï¼š${regionMap[key] || "æœªçŸ¥"}</p>
          <p>ç°ä»·ï¼š${val.price} ${val.currency}</p>
          <p>PEï¼š${val.pe ?? "æš‚æ— æ•°æ®"}</p>
          <p>52å‘¨åŒºé—´ï¼š${val.year_low} ~ ${val.year_high}</p>
        `;

        // å³ä¾§å›¾è¡¨
        const chartDiv = document.createElement("div");
        chartDiv.className = "chart";
        chartDiv.id = "chart-" + key;

        card.appendChild(info);
        card.appendChild(chartDiv);
        container.appendChild(card);

        // ECharts ç»˜åˆ¶
        const chart = echarts.init(chartDiv);
        chart.setOption({
          tooltip: { trigger: "axis" },
          xAxis: {
            type: "category",
            data: ["52å‘¨ä½ç‚¹", "ç°ä»·", "52å‘¨é«˜ç‚¹"],
          },
          yAxis: { type: "value" },
          series: [
            {
              name: key,
              type: "line",
              smooth: true,
              data: [val.year_low, val.price, val.year_high],
              lineStyle: { color: "#5470c6" },
              itemStyle: { color: "#91cc75" }
            }
          ]
        });
      });
    }

    loadData();
  </script>
</body>
</html>
